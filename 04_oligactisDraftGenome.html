<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>

<link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857143; overflow-x: hidden; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; tab-size: 4; background-position: inherit; background-repeat: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) { 
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font-family: inherit; font-size: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror-linenumber { }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; position: relative !important; background-position: inherit; background-repeat: inherit; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; background-position: 0px 0px; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print { 
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background-color: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background-color: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; }
a.md-print-anchor { white-space: pre !important; border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; text-shadow: initial !important; background-position: 0px 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background-color: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print { 
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit; background-repeat: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex: 2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) { 
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) { 
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.428571429rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left-width: 28px; border-left-style: solid; border-left-color: transparent; border-right-width: 28px; border-right-style: solid; border-right-color: transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right-width: 8px; border-right-style: solid; border-right-color: transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit; background-repeat: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; white-space: nowrap; background-position: inherit; background-repeat: inherit; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit; background-repeat: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit; background-repeat: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; border: none !important; background-position: 0px 0px !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; border-width: 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; background-position: 0px 0px; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-style: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-style: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background-color: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print { 
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, 'Segoe UI Emoji', sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

/*.html-for-mac {
    --item-hover-bg-color: #E6F0FE;
}*/

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
    opacity: 0.4;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

.menu-item-container a.menu-style-btn {
    background-color: #f5f8fa;
    background-image: linear-gradient( 180deg , hsla(0, 0%, 100%, 0.8), hsla(0, 0%, 100%, 0)); 
}


 @media print { @page {margin: 0 0 0 0;} body.typora-export {padding-left: 0; padding-right: 0;} #write {padding:0;}}
</style><title>04_oligactisDraftGenome</title>
</head>
<body class='typora-export'><div class='typora-export-content'>
<div id='write'  class=''><h1 id='assembling-and-annotating-a-draft-genome-assembly-for-hydra-oligactis'><span>Assembling and Annotating a Draft Genome Assembly for </span><em><span>Hydra oligactis</span></em></h1><p><span>This document describes our approach for assembling and annotating a draft genome for </span><em><span>Hydra oligactis</span></em><span>. This entailed assembling and polishing the genome using Oxford Nanopore reads, and generating gene models with BRAKER2 using previously published whole-animal RNA-seq data.  </span></p><div class='md-toc' mdtype='toc'><p class="md-toc-content" role="list"><span role="listitem" class="md-toc-item md-toc-h1" data-ref="n0"><a class="md-toc-inner" style="cursor: pointer;" href="#assembling-and-annotating-a-draft-genome-assembly-for-hydra-oligactis">Assembling and Annotating a Draft Genome Assembly for <em>Hydra oligactis</em></a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n4"><a class="md-toc-inner" style="cursor: pointer;" href="#downloading-sra-from-hydra-oligactis-rna-seq-dataset-from-ncbi">Downloading SRA from <em>Hydra oligactis</em> RNA-seq dataset from NCBI</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n20"><a class="md-toc-inner" style="cursor: pointer;" href="#basecalling-the-nanopore-reads">Basecalling the Nanopore reads</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n23"><a class="md-toc-inner" style="cursor: pointer;" href="#quality-assessement-of-the-nanopore-reads">Quality assessement of the Nanopore reads</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n26"><a class="md-toc-inner" style="cursor: pointer;" href="#concatenating-all-the-qc-passed-reads-for-assembly">Concatenating all the QC-passed reads for assembly</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n29"><a class="md-toc-inner" style="cursor: pointer;" href="#assembling-of-the-genome">assembling of the genome</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n33"><a class="md-toc-inner" style="cursor: pointer;" href="#qc-with-busco-on-the-newly-created-genome-file">QC with BUSCO on the newly created genome file</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n37"><a class="md-toc-inner" style="cursor: pointer;" href="#the-genome-file-was-then-polished-using-medaka">The genome file was then polished using medaka</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n41"><a class="md-toc-inner" style="cursor: pointer;" href="#qc-with-busco-on-the-polished-genome-file">QC with BUSCO on the polished genome file</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n46"><a class="md-toc-inner" style="cursor: pointer;" href="#soft-masking-repetitive-elements-in-the-genome">Soft-masking repetitive elements in the genome</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n48"><a class="md-toc-inner" style="cursor: pointer;" href="#mapping-the-de-novo-transcriptome-to-the-genome">Mapping the de-novo transcriptome to the genome</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n51"><a class="md-toc-inner" style="cursor: pointer;" href="#protein-prediction-with-braker2-pipeline">Protein prediction with braker2 pipeline</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n54"><a class="md-toc-inner" style="cursor: pointer;" href="#qc-of-the-predicted-proteins">QC of the predicted proteins</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n59"><a class="md-toc-inner" style="cursor: pointer;" href="#final-information">Final information</a></span><span role="listitem" class="md-toc-item md-toc-h3" data-ref="n61"><a class="md-toc-inner" style="cursor: pointer;" href="#files-associated-with-this-document">Files Associated with This Document</a></span></p></div><h3 id='downloading-sra-from-hydra-oligactis-rna-seq-dataset-from-ncbi'><span>Downloading SRA from </span><em><span>Hydra oligactis</span></em><span> RNA-seq dataset from NCBI</span></h3><p><span>To prepare a reference transcriptome to provide some intrinsic information about potential proteins for the protein prediction, we accessed publically available RNA-seq datasets from NCBI read archive. </span></p><ul><li><span>SRR9924176,  SRR9924177,  SRR9924178 were male animals </span></li><li><span>SRR11037672, SRR11037671, SRR11037670 were female animals)</span><br/><span>sratoolkit v2.10.5 was used to dump the *R1 and *R2 files seperately. </span></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/sratoolkit.2.10.5-ubuntu64/bin/fastq-dump SRR9924176 <span class="cm-attribute">--split-e</span> &amp; </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/sratoolkit.2.10.5-ubuntu64/bin/fastq-dump SRR9924177 <span class="cm-attribute">--split-e</span> &amp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/sratoolkit.2.10.5-ubuntu64/bin/fastq-dump SRR9924178 <span class="cm-attribute">--split-e</span> &amp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/sratoolkit.2.10.5-ubuntu64/bin/fastq-dump SRR11037672 <span class="cm-attribute">--split-e</span> &amp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/sratoolkit.2.10.5-ubuntu64/bin/fastq-dump SRR11037671 <span class="cm-attribute">--split-e</span> &amp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/sratoolkit.2.10.5-ubuntu64/bin/fastq-dump SRR11037670 <span class="cm-attribute">--split-e</span> &nbsp;</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 132px;"></div><div class="CodeMirror-gutters" style="display: none; height: 132px;"></div></div></div></pre><p><span>*R1 and *R2 accross the three sequencing runs from each dataset were concatenated. </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cat</span> SRR9924176_1.fastq SRR9924177_1.fastq SRR9924178_1.fastq &gt; male_1_1.fastq &nbsp;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cat</span> SRR9924176_2.fastq SRR9924177_2.fastq SRR9924178_2.fastq &gt; male_1_2.fastq &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cat</span> SRR11037672_1.fastq SRR11037671_1.fastq SRR11037670_1.fastq &gt; female_2_1.fastq &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cat</span> SRR11037672_2.fastq SRR11037671_2.fastq SRR11037670_2.fastq &gt; female_2_2.fastq</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 88px;"></div><div class="CodeMirror-gutters" style="display: none; height: 88px;"></div></div></div></pre><p><span>All four files were compressed using pigz v2.4</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/pigz *male*</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><p><span>Next, the script &quot;Trinity_and_Trinotate_final_version_PHIL&quot; was invoked to 1) quality assess the reads, 2) correct them using rcorrector, 3) trim them, 4) curate them using TranscriptomeAssemblyTools, and 5) quality assess them again prior to being assembled using Trinity. The finished transcriptome was then quality assessed using BUSCO in transcriptome mode. </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-meta">#!/bin/bash</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">####################################</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">TR_SPECIMENNAME</span><span class="cm-operator">=</span><span class="cm-string">"Hydra_male+female"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">TR_DATE</span><span class="cm-operator">=</span><span class="cm-string">"2021-04-19_phil"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">####################################</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#load envs</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-def">$PATH</span>:<span class="cm-def">$SOFTWARE</span>/rcorrector/</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-def">$PATH</span>:<span class="cm-def">$SOFTWARE</span>/salmon-latest_linux_x86_64/bin</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">TRINITY_HOME</span><span class="cm-operator">=</span><span class="cm-def">$SOFTWARE</span>/trinityrnaseq</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-def">$PATH</span>:<span class="cm-def">$SOFTWARE</span>/FastQC</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-def">$PATH</span>:<span class="cm-def">$SOFTWARE</span>/TrimGalore-0.6.6</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-string">"</span><span class="cm-def">$SOFTWARE</span><span class="cm-string">/augustus-3.3.3/bin:</span><span class="cm-def">$PATH</span><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-string">"</span><span class="cm-def">$SOFTWARE</span><span class="cm-string">/augustus-3.3.3/scripts:</span><span class="cm-def">$PATH</span><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">AUGUSTUS_CONFIG_PATH</span><span class="cm-operator">=</span><span class="cm-string">"</span><span class="cm-def">$SOFTWARE</span><span class="cm-string">/augustus-3.3.3/config/"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-def">$PATH</span>:<span class="cm-def">$SOFTWARE</span>/Prodigal</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-def">$PATH</span>:<span class="cm-def">$SOFTWARE</span>/sepp-master</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-def">$PATH</span>:<span class="cm-def">$SOFTWARE</span>/hmmer-3.3/src</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">BUSCO_CONFIG_FILE</span><span class="cm-operator">=</span><span class="cm-string">"</span><span class="cm-def">$SOFTWARE</span><span class="cm-string">/busco/config/myconfig.ini"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-string">"</span><span class="cm-def">$SOFTWARE</span><span class="cm-string">/ncbi-blast-2.10.0+/bin:</span><span class="cm-def">$PATH</span><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">export</span> <span class="cm-def">PATH</span><span class="cm-operator">=</span><span class="cm-def">$PATH</span>:<span class="cm-def">$SOFTWARE</span>/pigz-2.4/</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-comment">##Define variables</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-def">TR_LOG</span><span class="cm-operator">=</span><span class="cm-string">"log/general.log"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-def">TR_RESULTS_DIR</span><span class="cm-operator">=</span><span class="cm-string">"</span><span class="cm-def">${TR_SPECIMENNAME}</span><span class="cm-string">_trinity_</span><span class="cm-def">${TR_DATE}</span><span class="cm-string">_running"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> <span class="cm-def">TR_FINAL_DIR</span><span class="cm-operator">=</span><span class="cm-string">"</span><span class="cm-def">${TR_SPECIMENNAME}</span><span class="cm-string">_trinity_</span><span class="cm-def">${TR_DATE}</span><span class="cm-string">"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">timestamp() {</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">  date <span class="cm-operator">+</span><span class="cm-string">"%Y-%m-%d_%H-%M-%S"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## Create folder structures </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span> [ ! <span class="cm-attribute">-d</span> log ]; <span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">mkdir</span> log</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">mkdir</span> toBeDeleted</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">mkdir</span> <span class="cm-def">${TR_RESULTS_DIR}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">mkdir</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/fastqc</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">mkdir</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/busco</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">mkdir</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/rcorrector</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">mkdir</span> <span class="cm-def">${TR_FINAL_DIR}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">mkdir</span> <span class="cm-def">${TR_FINAL_DIR}</span>/fastqc</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">mkdir</span> <span class="cm-def">${TR_FINAL_DIR}</span>/busco</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">mkdir</span> <span class="cm-def">${TR_FINAL_DIR}</span>/trinotate</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-builtin">echo</span> <span class="cm-string">"All directories were created."</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">##versions of the software:</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">" &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Version of this script &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  "</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">" &nbsp; &nbsp; &nbsp; &nbsp; [12] 12. March  2021, Philip Bertemes &nbsp; &nbsp; &nbsp;  "</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">" parts of this script originate from T. Ostermann &nbsp; &nbsp; "</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"  *Trinity v.2.12 installed, changed version test &nbsp; &nbsp; "</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"  *Busco 5.0.0 installed &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  "</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">" &nbsp; Versions of the software used in this pipeline &nbsp; &nbsp; "</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"Rcorrector: commit ce5d06b"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">salmon <span class="cm-attribute">-v</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$TRINITY_HOME</span>/Trinity <span class="cm-attribute">--version</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">fastqc <span class="cm-attribute">-v</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">trim_galore <span class="cm-attribute">-v</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">augustus <span class="cm-attribute">--version</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">prodigal <span class="cm-attribute">-v</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"sepp: commit bd26318"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"hmmer: HMMER 3.3 November 2019)"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">blastn <span class="cm-attribute">-version</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">busco <span class="cm-attribute">-version</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"TranscriptomeAssemblyTools: commit e2df226"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">pigz <span class="cm-attribute">--version</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"******************************************************"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#THIS TEST WAS ADDED IN v8 OF THIS SCRIPT</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span> [ ! <span class="cm-attribute">-s</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/fastqc/unfixrm* ]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">##fastqc prior to corrections</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">timestamp <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"Start with fastqc with raw data"</span> &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/FastQC/fastqc *fastq.gz <span class="cm-attribute">--threads</span> <span class="cm-number">63</span> <span class="cm-attribute">--outdir</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/fastqc <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">##counter to find pairs of PE and add pass the right variable to "-s" in FilterUncorrectabledPEfastq.py</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">counter</span><span class="cm-operator">=</span><span class="cm-number">1</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">while</span> [ <span class="cm-def">$counter</span> <span class="cm-attribute">-le</span> <span class="cm-number">5</span> ]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">do</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">actualfile</span><span class="cm-operator">=</span><span class="cm-string">"_""</span><span class="cm-def">$counter</span><span class="cm-string">""_"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-def">$actualfile</span> &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span> <span class="cm-builtin">ls</span> <span class="cm-attribute">-la</span> | <span class="cm-builtin">grep</span> <span class="cm-def">$actualfile</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">##R-corrector</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  timestamp &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-string">"A file with ID "</span> <span class="cm-def">$actualfile</span> <span class="cm-string">" has been found in the directory. Start with rcorrector..."</span> &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  perl <span class="cm-def">$SOFTWARE</span>/rcorrector/run_rcorrector.pl <span class="cm-attribute">-1</span> *<span class="cm-def">$actualfile</span>*R1* <span class="cm-attribute">-2</span> *<span class="cm-def">$actualfile</span>*R2* <span class="cm-attribute">-t</span> <span class="cm-number">63</span> <span class="cm-attribute">-od</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/rcorrector <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> log/output_rcorrector.dat</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  timestamp &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-string">"Done with rcorrector on files with ID "</span> <span class="cm-def">$counter</span> <span class="cm-string">"."</span> &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">#TranscriptomeAssemblyTools https://informatics.fas.harvard.edu/best-practices-for-de-novo-transcriptome-assembly-with-trinity.html </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-string">"Start with TranscriptomeAssemblyTools on rcorrected-files with ID "</span> <span class="cm-def">$actualfile</span> <span class="cm-string">" in directory "</span> <span class="cm-def">${TR_RESULTS_DIR}</span><span class="cm-string">"/rcorrector/"</span> &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  python <span class="cm-def">$SOFTWARE</span>/TranscriptomeAssemblyTools/FilterUncorrectabledPEfastq.py <span class="cm-attribute">-1</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/rcorrector/*<span class="cm-def">$actualfile</span>*R1* <span class="cm-attribute">-2</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/rcorrector/*<span class="cm-def">$actualfile</span>*R2* <span class="cm-attribute">-s</span> <span class="cm-def">${TR_SPECIMENNAME}</span>_<span class="cm-def">$counter</span> &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> log/output_TranscriptomeAssemblyTools.dat</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  timestamp &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-string">"Done with TranscriptomeAssemblyTools on files with ID "</span> <span class="cm-def">$actualfile</span> <span class="cm-string">"."</span> &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">##Trim-TrimGalore https://github.com/FelixKrueger/TrimGalore/blob/master/Docs/Trim_Galore_User_Guide.md</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-string">"Start with Trimgalore on rcorrected-files and TAT-fixed files with ID "</span> <span class="cm-def">$actualfile</span> <span class="cm-string">" in the main directory, named unfixrm_......"</span><span class="cm-def">$actualfile</span><span class="cm-string">"...cor.fq"</span> &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  trim_galore <span class="cm-attribute">--paired</span> <span class="cm-attribute">--retain_unpaired</span> <span class="cm-attribute">--phred33</span> <span class="cm-attribute">--output_dir</span> trimmed_reads <span class="cm-attribute">--length</span> <span class="cm-number">36</span> <span class="cm-attribute">-q</span> <span class="cm-number">5</span> <span class="cm-attribute">--stringency</span> <span class="cm-number">1</span> <span class="cm-attribute">-e</span> <span class="cm-number">0</span>.1 unfixrm*<span class="cm-def">$actualfile</span>*R1* unfixrm*<span class="cm-def">$actualfile</span>*R2* <span class="cm-attribute">--cores</span> <span class="cm-number">64</span> <span class="cm-attribute">--gzip</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> log/output_trimgalore.dat</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  timestamp  | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> log/output_trimgalore.dat <span class="cm-number">2</span>&gt;&amp;1</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-string">"Done with TrimGalore on files with ID "</span> <span class="cm-def">$actualfile</span> <span class="cm-string">"."</span> &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-string">"no pair with ID </span><span class="cm-def">$actualfile</span><span class="cm-string"> found"</span> &nbsp; <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span> ; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">((counter<span class="cm-operator">++</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">done</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">timestamp <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"Concatenating all corrected and validated R1 files to left.fq.gz"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">zcat trimmed_reads/*R1*cor_val_1.fq.gz | pigz &gt; trimmed_reads/left.fq.gz</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">timestamp <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"Concatenating all corrected and validated R2 files to right.fq.gz"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">zcat trimmed_reads/*R2*cor_val_2.fq.gz | pigz &gt; trimmed_reads/right.fq.gz</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># ##fastqc after corrections</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">timestamp <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"Start with fastqc after rcorrector, TranscriptomeAssemblyTools, and TrimGalore!"</span> &nbsp; <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/FastQC/fastqc trimmed_reads/*cor_val_*.fq.gz <span class="cm-attribute">--threads</span> <span class="cm-number">63</span> <span class="cm-attribute">--outdir</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/fastqc <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> log/output_fastqc.dat | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># TEST ENDS HERE</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">fi</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">##Trinity</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">timestamp &nbsp;<span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">echo</span> <span class="cm-string">"Start with Trinity..."</span> &nbsp; <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># ATTENTION we can use --monitor to start collectl. </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$TRINITY_HOME</span>/Trinity \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--seqType</span> fq \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--max_memory</span> 250G \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--CPU</span> <span class="cm-number">63</span> \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--no_salmon</span> \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--SS_lib_type</span> RF \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--left</span> trimmed_reads/left.fq.gz \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--right</span> trimmed_reads/right.fq.gz \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-attribute">--output</span> <span class="cm-def">${TR_RESULTS_DIR}</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> log/output_trinity.dat</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#THIS TEST IF CONSTRUCT WAS ADDED IN V8 OF THIS SCRIPT</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-keyword">if</span> tail <span class="cm-attribute">-100</span> log/output_trinity.dat | <span class="cm-builtin">grep</span> <span class="cm-string">"Trinity assemblies are written to"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  timestamp <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-string">"TRINITY ASSEMBLIES WERE FOUND. CONTINUE WITH THE PIPELINE!"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">##Trinity STATS generieren</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># ATTENTION we can use --monitor to start collectl. If --monitor was used in Trinity command, uncomment the examine_resource_usage_profiling.pl script in the next line</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$TRINITY_HOME</span>/util/TrinityStats.pl <span class="cm-def">${TR_RESULTS_DIR}</span>/Trinity.fasta &gt;&gt; <span class="cm-def">${TR_RESULTS_DIR}</span>/TrinityStats.txt</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#$TRINITY_HOME/trinity-plugins/COLLECTL/examine_resource_usage_profiling.pl collectl</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## Path-Informationen aus Fasta-File entfernen (von Trinity):</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cp</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/Trinity.fasta ./log/<span class="cm-def">${TR_SPECIMENNAME}</span>_<span class="cm-def">${TR_DATE}</span>_Trinity-ORIGINAL.fasta</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">sed</span> <span class="cm-string">'s/ path.*//'</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/Trinity.fasta &gt;&gt; <span class="cm-def">${TR_RESULTS_DIR}</span>/Trinity_ohnePath.fasta</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">sed</span> <span class="cm-string">"s/&gt;TRINITY/&gt;</span><span class="cm-def">${TR_SPECIMENNAME}</span><span class="cm-string">/"</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/Trinity_ohnePath.fasta &gt;&gt; <span class="cm-def">${TR_RESULTS_DIR}</span>/<span class="cm-def">${TR_SPECIMENNAME}</span>_<span class="cm-def">${TR_DATE}</span>.fasta</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">##Run the new busco v.4. ATTENTION 20200115phil_: BLAST v2.6 has an issue with multi-thread in Busco. Busco constraints tblastn to one single core!</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span>python3 <span class="cm-def">$SOFTWARE</span>/busco/src/busco/run_BUSCO.py \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-attribute">-o</span> busco \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-attribute">-i</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/<span class="cm-def">${TR_SPECIMENNAME}</span>_<span class="cm-def">${TR_DATE}</span>.fasta \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-attribute">-l</span> metazoa_odb10 \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-attribute">-m</span> transcriptome \</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-attribute">--cpu</span> <span class="cm-number">63</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">##this was added in verison 12 of my script</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">##rename the busco output</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">mv</span> busco/short_summary.* busco/short_summary.specific.metazoa_odb10.<span class="cm-def">${TR_SPECIMENNAME}</span>_<span class="cm-def">${TR_DATE}</span>.txt</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" class="cm-tab-wrap-hack" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## generate Figure...</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">python3 <span class="cm-def">$SOFTWARE</span>/busco/scripts/generate_plot.py <span class="cm-attribute">-wd</span> busco <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> log/output_busco.log</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="" cm-zwsp="">
</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">if</span> [ <span class="cm-attribute">-s</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/<span class="cm-def">${TR_SPECIMENNAME}</span>_<span class="cm-def">${TR_DATE}</span>.fasta ]</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">then</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">mv</span> *.log log/</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">mv</span> busco* <span class="cm-def">${TR_FINAL_DIR}</span>/busco</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">mv</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/fastqc <span class="cm-def">${TR_FINAL_DIR}</span>/fastqc</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">mv</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/<span class="cm-def">${TR_SPECIMENNAME}</span>_<span class="cm-def">${TR_DATE}</span>.fasta <span class="cm-def">${TR_FINAL_DIR}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">mv</span> <span class="cm-def">${TR_RESULTS_DIR}</span>/TrinityStats.txt <span class="cm-def">${TR_FINAL_DIR}</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">mv</span> log/ <span class="cm-def">${TR_FINAL_DIR}</span>/log</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">mv</span> unfix* toBeDeleted/</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">mv</span> *fastq* toBeDeleted/</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">mv</span> <span class="cm-def">${TR_RESULTS_DIR}</span> toBeDeleted/</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">mv</span> trimmed_reads toBeDeleted/</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-comment">#mv *collectl* log/</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">else</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-builtin">echo</span> <span class="cm-string">"Trinity has not finished correctly. Please check what went wrong, and restart!"</span> <span class="cm-number">2</span>&gt;&amp;1 | <span class="cm-builtin">tee</span> <span class="cm-attribute">-a</span> <span class="cm-def">$TR_LOG</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">fi</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 5038px;"></div><div class="CodeMirror-gutters" style="display: none; height: 5038px;"></div></div></div></pre><h3 id='basecalling-the-nanopore-reads'><span>Basecalling the Nanopore reads</span></h3><p><span>Two libraries were prepared to generate long reads for </span><em><span>Hydra oligactis</span></em><span>. The first library was loaded 2 times on a Nanopore flow cell, resulting in two read files (lib1_1 and lib1_2). The second library was loaded 6 times. All 8 files were basecalled using the guppy basecaller v4.5.2 using the high accuracy moodel (HAC) over a NVidia 2070Super GPU. </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/ont-guppy/bin/guppy_basecaller <span class="cm-attribute">--min_qscore</span> <span class="cm-number">7</span> <span class="cm-attribute">-i</span> ../../nanopore_raw/Hydra_oligactis/Hydra_oli_SRE_XS_lib1_1/*/fast5/ <span class="cm-attribute">-s</span> Hydra_oli_SRE_XS_lib1_1_HAC_guppy452 <span class="cm-attribute">-c</span> <span class="cm-def">$SOFTWARE</span>/ont-guppy/data/dna_r9.4.1_450bps_hac.cfg <span class="cm-attribute">-x</span> <span class="cm-string">'cuda:0'</span> <span class="cm-attribute">--num_callers</span> <span class="cm-number">4</span> <span class="cm-attribute">--gpu_runners_per_device</span> <span class="cm-number">8</span> </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/ont-guppy/bin/guppy_basecaller <span class="cm-attribute">--min_qscore</span> <span class="cm-number">7</span> <span class="cm-attribute">-i</span> ../../nanopore_raw/Hydra_oligactis/Hydra_oli_SRE_XS_lib1_2/*/fast5/ <span class="cm-attribute">-s</span> Hydra_oli_SRE_XS_lib1_2_HAC_guppy452 <span class="cm-attribute">-c</span> <span class="cm-def">$SOFTWARE</span>/ont-guppy/data/dna_r9.4.1_450bps_hac.cfg <span class="cm-attribute">-x</span> <span class="cm-string">'cuda:0'</span> <span class="cm-attribute">--num_callers</span> <span class="cm-number">4</span> <span class="cm-attribute">--gpu_runners_per_device</span> <span class="cm-number">8</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/ont-guppy/bin/guppy_basecaller <span class="cm-attribute">--min_qscore</span> <span class="cm-number">7</span> <span class="cm-attribute">-i</span> ../../nanopore_raw/Hydra_oligactis/Hydra_oli_SRE_XS_lib2_1/*/fast5/ <span class="cm-attribute">-s</span> Hydra_oli_SRE_XS_lib2_1_HAC_guppy452 <span class="cm-attribute">-c</span> <span class="cm-def">$SOFTWARE</span>/ont-guppy/data/dna_r9.4.1_450bps_hac.cfg <span class="cm-attribute">-x</span> <span class="cm-string">'cuda:0'</span> <span class="cm-attribute">--num_callers</span> <span class="cm-number">4</span> <span class="cm-attribute">--gpu_runners_per_device</span> <span class="cm-number">8</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/ont-guppy/bin/guppy_basecaller <span class="cm-attribute">--min_qscore</span> <span class="cm-number">7</span> <span class="cm-attribute">-i</span> ../../nanopore_raw/Hydra_oligactis/Hydra_oli_SRE_XS_lib2_2/*/fast5/ <span class="cm-attribute">-s</span> Hydra_oli_SRE_XS_lib2_2_HAC_guppy452 <span class="cm-attribute">-c</span> <span class="cm-def">$SOFTWARE</span>/ont-guppy/data/dna_r9.4.1_450bps_hac.cfg <span class="cm-attribute">-x</span> <span class="cm-string">'cuda:0'</span> <span class="cm-attribute">--num_callers</span> <span class="cm-number">4</span> <span class="cm-attribute">--gpu_runners_per_device</span> <span class="cm-number">8</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/ont-guppy/bin/guppy_basecaller <span class="cm-attribute">--min_qscore</span> <span class="cm-number">7</span> <span class="cm-attribute">-i</span> ../../nanopore_raw/Hydra_oligactis/Hydra_oli_SRE_XS_lib2_3/*/fast5/ <span class="cm-attribute">-s</span> Hydra_oli_SRE_XS_lib2_3_HAC_guppy452 <span class="cm-attribute">-c</span> <span class="cm-def">$SOFTWARE</span>/ont-guppy/data/dna_r9.4.1_450bps_hac.cfg <span class="cm-attribute">-x</span> <span class="cm-string">'cuda:0'</span> <span class="cm-attribute">--num_callers</span> <span class="cm-number">4</span> <span class="cm-attribute">--gpu_runners_per_device</span> <span class="cm-number">8</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/ont-guppy/bin/guppy_basecaller <span class="cm-attribute">--min_qscore</span> <span class="cm-number">7</span> <span class="cm-attribute">-i</span> ../../nanopore_raw/Hydra_oligactis/Hydra_oli_SRE_XS_lib2_4/*/fast5/ <span class="cm-attribute">-s</span> Hydra_oli_SRE_XS_lib2_4_HAC_guppy452 <span class="cm-attribute">-c</span> <span class="cm-def">$SOFTWARE</span>/ont-guppy/data/dna_r9.4.1_450bps_hac.cfg <span class="cm-attribute">-x</span> <span class="cm-string">'cuda:0'</span> <span class="cm-attribute">--num_callers</span> <span class="cm-number">4</span> <span class="cm-attribute">--gpu_runners_per_device</span> <span class="cm-number">8</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/ont-guppy/bin/guppy_basecaller <span class="cm-attribute">--min_qscore</span> <span class="cm-number">7</span> <span class="cm-attribute">-i</span> ../../nanopore_raw/Hydra_oligactis/Hydra_oli_SRE_XS_lib2_5/*/fast5/ <span class="cm-attribute">-s</span> Hydra_oli_SRE_XS_lib2_5_HAC_guppy452 <span class="cm-attribute">-c</span> <span class="cm-def">$SOFTWARE</span>/ont-guppy/data/dna_r9.4.1_450bps_hac.cfg <span class="cm-attribute">-x</span> <span class="cm-string">'cuda:0'</span> <span class="cm-attribute">--num_callers</span> <span class="cm-number">4</span> <span class="cm-attribute">--gpu_runners_per_device</span> <span class="cm-number">8</span> </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/ont-guppy/bin/guppy_basecaller <span class="cm-attribute">--min_qscore</span> <span class="cm-number">7</span> <span class="cm-attribute">-i</span> ../../nanopore_raw/Hydra_oligactis/Hydra_oli_SRE_XS_lib2_6/*/fast5/ <span class="cm-attribute">-s</span> Hydra_oli_SRE_XS_lib2_6_HAC_guppy452 <span class="cm-attribute">-c</span> <span class="cm-def">$SOFTWARE</span>/ont-guppy/data/dna_r9.4.1_450bps_hac.cfg <span class="cm-attribute">-x</span> <span class="cm-string">'cuda:0'</span> <span class="cm-attribute">--num_callers</span> <span class="cm-number">4</span> <span class="cm-attribute">--gpu_runners_per_device</span> <span class="cm-number">8</span> </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 528px;"></div><div class="CodeMirror-gutters" style="display: none; height: 528px;"></div></div></div></pre><h3 id='quality-assessement-of-the-nanopore-reads'><span>Quality assessement of the Nanopore reads</span></h3><p><span>Next, we ran NanoPlot v1.30.1 to quality assess each of the &quot;runs&quot;. </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">NanoPlot <span class="cm-attribute">--summary</span> Hydra_oli_SRE_XS_lib1_1_HAC_guppy452/sequencing_summary.txt <span class="cm-attribute">--N50</span> <span class="cm-attribute">--o</span> NANOPLOT_Hydra_oli_SRE_XS_lib1_1_HAC_guppy452 <span class="cm-attribute">-t</span> <span class="cm-number">60</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">NanoPlot <span class="cm-attribute">--summary</span> Hydra_oli_SRE_XS_lib1_2_HAC_guppy452/sequencing_summary.txt <span class="cm-attribute">--N50</span> <span class="cm-attribute">--o</span> NANOPLOT_Hydra_oli_SRE_XS_lib1_2_HAC_guppy452 <span class="cm-attribute">-t</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">NanoPlot <span class="cm-attribute">--summary</span> Hydra_oli_SRE_XS_lib2_1_HAC_guppy452/sequencing_summary.txt <span class="cm-attribute">--N50</span> <span class="cm-attribute">--o</span> NANOPLOT_Hydra_oli_SRE_XS_lib2_1_HAC_guppy452 <span class="cm-attribute">-t</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">NanoPlot <span class="cm-attribute">--summary</span> Hydra_oli_SRE_XS_lib2_2_HAC_guppy452/sequencing_summary.txt <span class="cm-attribute">--N50</span> <span class="cm-attribute">--o</span> NANOPLOT_Hydra_oli_SRE_XS_lib2_2_HAC_guppy452 <span class="cm-attribute">-t</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">NanoPlot <span class="cm-attribute">--summary</span> Hydra_oli_SRE_XS_lib2_3_HAC_guppy452/sequencing_summary.txt <span class="cm-attribute">--N50</span> <span class="cm-attribute">--o</span> NANOPLOT_Hydra_oli_SRE_XS_lib2_3_HAC_guppy452 <span class="cm-attribute">-t</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">NanoPlot <span class="cm-attribute">--summary</span> Hydra_oli_SRE_XS_lib2_4_HAC_guppy452/sequencing_summary.txt <span class="cm-attribute">--N50</span> <span class="cm-attribute">--o</span> NANOPLOT_Hydra_oli_SRE_XS_lib2_4_HAC_guppy452 <span class="cm-attribute">-t</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">NanoPlot <span class="cm-attribute">--summary</span> Hydra_oli_SRE_XS_lib2_5_HAC_guppy452/sequencing_summary.txt <span class="cm-attribute">--N50</span> <span class="cm-attribute">--o</span> NANOPLOT_Hydra_oli_SRE_XS_lib2_5_HAC_guppy452 <span class="cm-attribute">-t</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">NanoPlot <span class="cm-attribute">--summary</span> Hydra_oli_SRE_XS_lib2_6_HAC_guppy452/sequencing_summary.txt <span class="cm-attribute">--N50</span> <span class="cm-attribute">--o</span> NANOPLOT_Hydra_oli_SRE_XS_lib2_6_HAC_guppy452 <span class="cm-attribute">-t</span> <span class="cm-number">60</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">NanoPlot <span class="cm-attribute">--summary</span> Hydra_oli_SRE_XS_*/sequencing_summary.txt <span class="cm-attribute">--N50</span> <span class="cm-attribute">--o</span> NANOPLOT_Hydra_oli_SRE_XS_lib1<span class="cm-operator">+</span>2complete_HAC_guppy452 <span class="cm-attribute">-t</span> <span class="cm-number">60</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 396px;"></div><div class="CodeMirror-gutters" style="display: none; height: 396px;"></div></div></div></pre><h3 id='concatenating-all-the-qc-passed-reads-for-assembly'><span>Concatenating all the QC-passed reads for assembly</span></h3><p><span>All the reads from the 8 individual &quot;runs&quot; passing the guppy basecaller QC criteria (Q-Score &gt;7) were now concatenated into a single fastq file. </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">cat</span> Hydra_oli_SRE_XS_lib*_HAC_guppy452/pass/Hydra*.fastq &gt; Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_HACguppy452.fastq</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><h3 id='assembling-of-the-genome'><span>assembling of the genome</span></h3><p><span>Then, the Flye v2.8.3 assembler was run to generate the genome</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/Flye/bin/flye <span class="cm-attribute">--nano-raw</span> Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_HACguppy452.fastq <span class="cm-attribute">--threads</span> <span class="cm-number">62</span> <span class="cm-attribute">-o</span> Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_guppy452_flye283 </span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">mv</span> Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_guppy452_flye283/assembly.fasta Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_guppy452_flye283.fasta</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 66px;"></div><div class="CodeMirror-gutters" style="display: none; height: 66px;"></div></div></div></pre><p><span>Assembly on flye 283 finished with the following metrics:</span>
<span>  Total length:    1283640785 </span>
<span>     Fragments:    18685 </span>
<span>     Fragments N50:    272153 </span>
<span>     Largest frg:    6425239 </span>
<span>     Scaffolds:    114 </span>
<span>     Mean coverage:    17 </span></p><h3 id='qc-with-busco-on-the-newly-created-genome-file'><span>QC with BUSCO on the newly created genome file</span></h3><p><span>We checked the genome file for completeness using BUSCO v5.0.0 in genome mode</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">busco <span class="cm-attribute">-i</span> Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_guppy452_flye283.fasta <span class="cm-attribute">-o</span> busco <span class="cm-attribute">-l</span> metazoa_odb10 <span class="cm-attribute">-m</span> genome <span class="cm-attribute">-c</span> <span class="cm-number">62</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |Results from dataset metazoa_odb10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  -------------------------------------------------- </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |C:89.2%[S:76.1%,D:13.1%],F:5.7%,M:5.1%,n:954 &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |851 &nbsp;  Complete BUSCOs (C) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |726 &nbsp;  Complete and single-copy BUSCOs (S) &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |125 &nbsp;  Complete and duplicated BUSCOs (D) &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |54 &nbsp; &nbsp; Fragmented BUSCOs (F) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |49 &nbsp; &nbsp; Missing BUSCOs (M) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |954 &nbsp;  Total BUSCO groups searched &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  -------------------------------------------------- </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 220px;"></div><div class="CodeMirror-gutters" style="display: none; height: 220px;"></div></div></div></pre><h3 id='the-genome-file-was-then-polished-using-medaka'><span>The genome file was then polished using medaka</span></h3><p><span>&quot;Raw&quot; draft assemblies using uncorrected Nanopore reads are known to contain some errors, especially in homopolymer-regions. A software (medaka) was developped to find and correct these errors. We used the best medaka model, however, it was trained on guppy v3.0.3 basecalled data, which was not as accurate as the guppy v4.5.2 used to basecall the data from the present genome. </span></p><p><span>. $SOFTWARE/medaka/bin/activate </span>
<span>PATH=$SOFTWARE/htslib-1.11/:$PATH </span>
<span>PATH=$SOFTWARE/samtools-1.11/:$PATH </span>
<span>PATH=$SOFTWARE/minimap2/:$PATH </span>
<span>PATH=$SOFTWARE/bcftools/:$PATH </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">medaka_consensus <span class="cm-attribute">-i</span> Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_HACguppy452.fastq <span class="cm-attribute">-d</span> Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_HACguppy452_flye283.fasta <span class="cm-attribute">-o</span> medaka_1_on_flye_original <span class="cm-attribute">-t</span> <span class="cm-number">60</span> m r941_min_high_g303</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### This script breaks before the stitch, so it has to be invoked after medaka has finished</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">medaka stitch medaka_1_on_flye_original/consensus_probs.hdf Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_HACguppy452_flye283.fasta Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_HACguppy452_flye283_medaka1.fasta <span class="cm-attribute">--threads</span> <span class="cm-number">60</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 110px;"></div><div class="CodeMirror-gutters" style="display: none; height: 110px;"></div></div></div></pre><h3 id='qc-with-busco-on-the-polished-genome-file'><span>QC with BUSCO on the polished genome file</span></h3><p><span>The polished genome was rechecked with BUSCO v5.0.0 to check for improvements</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">busco <span class="cm-attribute">-i</span> Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_guppy452_flye283_medaka1.fasta <span class="cm-attribute">-o</span> busco <span class="cm-attribute">-l</span> metazoa_odb10 <span class="cm-attribute">-m</span> genome <span class="cm-attribute">-c</span> <span class="cm-number">62</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 22px;"></div><div class="CodeMirror-gutters" style="display: none; height: 22px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|Results from dataset metazoa_odb10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">-------------------------------------------------- </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|C:90.2%[S:77.1%,D:13.1%],F:5.3%,M:4.5%,n:954</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|861 &nbsp;  Complete BUSCOs (C)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|736 &nbsp;  Complete and single-copy BUSCOs (S) </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|125 &nbsp;  Complete and duplicated BUSCOs (D)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|51 &nbsp; &nbsp; Fragmented BUSCOs (F) &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|42 &nbsp; &nbsp; Missing BUSCOs (M) &nbsp; </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">|954 Total BUSCO groups searched</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">--------------------------------------------------</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 220px;"></div><div class="CodeMirror-gutters" style="display: none; height: 220px;"></div></div></div></pre><p>&nbsp;</p><h3 id='soft-masking-repetitive-elements-in-the-genome'><span>Soft-masking repetitive elements in the genome</span></h3><p><span>Before generating gene models for the </span><em><span>oligactis</span></em><span> genome, we first soft-masked all repeats in the draft assembly. The process for generating the masked version of the genome (</span><code>olig_genome.sm.fa</code><span>) is described in the </span><code>02_repeatMasking.md</code><span> document.</span></p><h3 id='mapping-the-de-novo-transcriptome-to-the-genome'><span>Mapping the de-novo transcriptome to the genome</span></h3><p><span>The next part is the protein prediction on the new genome file. First, the newly generated transcriptome gets mapped to the genome using minimap2 </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">$SOFTWARE</span>/minimap2/minimap2 <span class="cm-attribute">-ax</span> splice olig_genome.sm.fa Hydra_male<span class="cm-operator">+</span>female_2021-04-19_phil.fasta <span class="cm-attribute">-t</span> <span class="cm-number">62</span>  &gt; transcriptome_malefemale.sam; <span class="cm-def">$SOFTWARE</span>/samtools-1.11/samtools <span class="cm-builtin">sort</span> <span class="cm-attribute">-</span>@ <span class="cm-number">60</span> transcriptome_malefemale.sam &gt; transcriptome_malefemale.bam</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 66px;"></div><div class="CodeMirror-gutters" style="display: none; height: 66px;"></div></div></div></pre><h3 id='protein-prediction-with-braker2-pipeline'><span>Protein prediction with braker2 pipeline</span></h3><p><span>Finally, we started the braker2 pipeline (in a conda environment) to predict proteins</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">conda activate braker</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">braker.pl <span class="cm-attribute">--species</span><span class="cm-operator">=</span>Hydraoli_20211201 <span class="cm-attribute">--genome</span><span class="cm-operator">=</span>olig_genome.sm.fa <span class="cm-attribute">--bam</span><span class="cm-operator">=</span>transcriptome_malefemale.bam <span class="cm-attribute">--cores</span><span class="cm-operator">=</span><span class="cm-number">62</span> <span class="cm-attribute">-gff3</span> <span class="cm-attribute">--softmasking</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 66px;"></div><div class="CodeMirror-gutters" style="display: none; height: 66px;"></div></div></div></pre><h3 id='qc-of-the-predicted-proteins'><span>QC of the predicted proteins</span></h3><p><span>In addition, we ran BUSCO v5.2.2 (now in a conda environment) in protein mode to check for completeness of the predicted proteins. </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="bash"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="bash"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">conda activate busco</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">busco <span class="cm-attribute">-i</span> Hydra_lib1<span class="cm-operator">+</span>2_complete_q7_guppy452_flye283_medaka1.fasta <span class="cm-attribute">-o</span> busco <span class="cm-attribute">-l</span> metazoa_odb10 <span class="cm-attribute">-m</span> genome <span class="cm-attribute">-c</span> <span class="cm-number">62</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 44px;"></div></div></div></pre><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; |Results from dataset metazoa_odb10 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  -------------------------------------------------- </span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |C:86.4%[S:71.0%,D:15.4%],F:7.8%,M:5.8%,n:954</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |824 &nbsp; &nbsp; Complete BUSCOs (C)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |677 &nbsp; &nbsp; Complete and single-copy BUSCOs (S)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |147 &nbsp; &nbsp; Complete and duplicated BUSCOs (D)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |74 &nbsp; &nbsp;  Fragmented BUSCOs (F)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |56 &nbsp; &nbsp;  Missing BUSCOs (M)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  |954 &nbsp; &nbsp; Total BUSCO groups searched</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  -------------------------------------------------- </span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 220px;"></div><div class="CodeMirror-gutters" style="display: none; height: 220px;"></div></div></div></pre><p><span>        </span></p><h3 id='final-information'><span>Final information</span></h3><p><span>The computational needs for this complete project did not exceed the power provided by a workstation containing </span>
<span>    * AMD Ryzen Threadripper 3970X 32-Core Processor</span>
<span>    * 256G memory</span>
<span>    * NVidia 2070Super</span></p><h3 id='files-associated-with-this-document'><span>Files Associated with This Document</span></h3><p>&nbsp;</p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">04_oligactisDraftGenome/</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">├── assembly.fasta</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>Initial draft assembly of the H. oligactis genome generated by Flye using Nanopore reads.</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">├── assemblyPolish.fasta</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>Updated version of the H. oligactis draft genome following error correction with Medaka</span></pre></div><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>using Nanopore data.</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">├── augustusSpeciesHyOli.tar.gz</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>Folder containing the optimized Augustus gene prediction parameters for the H. oligactis </span></pre></div><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>assembly generated by BRAKER2.</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">├── braker.gff3</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>GFF3-formatted file containing the Initial gene models for the H. oligactis assembly </span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>generated by Braker2 using previously published whole-animal RNA-seq data as hints.</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">├── braker.gtf</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>GTF-formatted file containing the Initial gene models for the H. oligactis assembly </span></pre></div><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>generated by Braker2 using previously published whole-animal RNA-seq data as hints.</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">└── Hydra_male+female_2021-04-19_phil.fasta</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>De-novo H. oligactis transcriptome generated with Trinity using previously published</span></pre><div class="" style="position: relative;"><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-tab" role="presentation" cm-text="	">  </span><span class="cm-tab" role="presentation" cm-text="	">  </span>whole-animal RNA-seq data. Used as hints for the BRAKER2 annotation pipeline.</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 396px;"></div><div class="CodeMirror-gutters" style="display: none; height: 396px;"></div></div></div></pre><p>&nbsp;</p></div></div>
</body>
</html>